---
title: "Midterm Project"
output: github_document
---

###Setup

```{r setup, message = FALSE }
library(tidyverse)
library(knitr)
library(patchwork)
library(viridis)
library(wordcountaddin)
```

###Data Cleaning

```{r clean_data, message = FALSE}
accel_data = read_csv(file = "data/p8105_mtp_data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(day = as.factor(day)) %>% 
  mutate(day = 
           factor(day, levels = 
                    c("Sunday", "Monday", "Tuesday", 
                      "Wednesday", "Thursday",
                      "Friday", "Saturday"), 
                  ordered = TRUE)) %>% 
  arrange(day) %>% 
  arrange(week) %>% 
  mutate(total_act = rowSums(.[,3:1440], na.rm = TRUE)) %>% 
  mutate(avg_act = rowMeans(.[,3:1440], na.rm = TRUE))

```

This dataset consists of week, day, and activity variables. Each activity column represents a summary of the voltage signal in a minute of the day. There are 329 rows and 1,442 variables total.

```{r total_act_per_day_over_time}
year_plot = ggplot(accel_data, aes(x = week, y = total_act)) +
  geom_point() +
  geom_smooth()
year_plot
```

```{r all_weeks_avg_per_day}
week_plot = ggplot(accel_data, aes(x = day, y = avg_act)) + 
  geom_boxplot()
week_plot
```

```{r 24_hour_week}
week_hour_act = accel_data %>% 
  gather(key = daily_act, value = activity, activity_1:activity_1440) %>% 
  filter(week == 30) %>% 
  mutate(daily_act = str_replace(daily_act, "activity_", "")) %>% 
  mutate(daily_act = as.numeric(daily_act) / 60)

week_hour_plot = ggplot(week_hour_act, aes(x = daily_act, y = activity)) +
  geom_point() +
  scale_x_continuous(breaks = seq(0, 24, by = 6)) +
  facet_grid(. ~ day) +
  geom_smooth()
week_hour_plot
```

```{r 24_hour_sunday}
sunday_act = accel_data %>% 
  gather(key = daily_act, value = activity, activity_1:activity_1440) %>%
  filter(day == "Sunday", week == 45) %>% 
  mutate(daily_act = str_replace(daily_act, "activity_", "")) %>% 
  mutate(daily_act = as.numeric(daily_act) / 60)

sunday_plot = ggplot(sunday_act, aes(x = daily_act, y = activity)) +
  geom_point() +
  scale_x_continuous(breaks = seq(0, 24, by = 2)) +
  facet_grid(. ~ day) +
  geom_smooth()
sunday_plot
```




```{r}
wordcountaddin::text_stats("p8105_mtp_jih2119.Rmd")
```


